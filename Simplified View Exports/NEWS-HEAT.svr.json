{"simplified_view":"reports","reports":[],"custom_reports":[{"title":"User Details","type":"SQL","description":"User Name, Full Name, User Type (role), User Email, Access Site (DAG)\n\nDisplays all current system users, including role and DAG membership.","permissions":"<b>View Access:<\/b>\nAdministrator\nData Management\nData Management +\nTrial Management\n<i>Can retrieve as image<\/i>\n<b>Download:<\/b>\nAdministrator\nData Management\nData Management +\nTrial Management","definition":"SELECT DISTINCT uri.username AS 'User Name', \n       CONCAT(ui.user_firstname, ' ' ,ui.user_lastname) AS 'Full Name', \n       uro.role_name AS 'User Role'  , \n       ui.user_email AS 'User Email',\n       if(dag.group_id, dag.group_name, 'All') AS 'DAG Membership'\nFROM redcap_user_rights as uri\nLEFT JOIN redcap_user_roles as uro ON uro.project_id = uri.project_id AND uro.role_id = uri.role_id\nLEFT JOIN redcap_data_access_groups as dag ON dag.project_id = uri.project_id AND dag.group_id = uri.group_id\nLEFT JOIN redcap_user_information as ui ON ui.username = uri.username\nWHERE uri.project_id=$$PROJECT$$\nORDER BY uro.role_name, dag.group_id;","options":""},{"title":"Calculated Fields","type":"SQL","description":"Displays all variables that are 'Calculated Fields'.\nField type = 'Calculated field', or @CALCDATE or @CALCTEXT action tag used.\nData Category, Form Name, Variable Label, Field Name, Derivation","permissions":"<b>View Access:<\/b>\nData Management\nData Management +\nTrial Management\n<b>Download:<\/b>\nData Management\nData Management +\nTrial Management","definition":"SELECT 'Calculated Field' as \"Data Category\",\n       form_name as \"Form Name\",\n       element_label as \"Variable Label\",\n       field_name as \"Field Name\",\n       IF( element_type = 'calc',\n           element_enum, \n           IF( INSTR(misc, '@CALCDATE') > 0,\n               IF( INSTR(MID(misc, LOCATE('@CALCDATE', misc)+1, LENGTH(misc) - LOCATE('@CALCDATE', misc)), '@') > 0,\n                   MID(misc, LOCATE('@CALCDATE', misc), LOCATE('@', MID(misc, LOCATE('@CALCDATE', misc)+1, LENGTH(misc) - LOCATE('@CALCDATE', misc)))),\n                   MID(misc, LOCATE('@CALCDATE', misc)+1, LENGTH(misc) - LOCATE('@CALCDATE', misc))), \n               IF( INSTR(misc, '@CALCTEXT') > 0,\n                   IF( INSTR(MID(misc, LOCATE('@CALCTEXT', misc)+1, LENGTH(misc) - LOCATE('@CALCTEXT', misc)), '@') > 0,\n                       MID(misc, LOCATE('@CALCTEXT', misc), LOCATE('@', MID(misc, LOCATE('@CALCTEXT', misc)+1, LENGTH(misc) - LOCATE('@CALCTEXT', misc)))),\n                       MID(misc, LOCATE('@CALCTEXT', misc)+1, LENGTH(misc) - LOCATE('@CALCTEXT', misc))),\n                   '') ) ) as Derivation\nFROM redcap_metadata\nWHERE project_id = $$PROJECT$$\n      -- AND INSTR(ifnull(misc, ''), '@HIDDEN') = 0 \n      AND ( INSTR(misc, '@CALCDATE') <> 0 OR INSTR(misc, '@CALCTEXT') <> 0 OR element_type = 'calc' )","options":""},{"title":"Free Text Fields","type":"SQL","description":"record, form_name, event, instance, field_name, element_label, value\n\nDisplays all free text fields not flagged as 'Identifier' for easy review.","permissions":"<b>View Access:<\/b>\nAdministrator\nData Management\nData Management +\nTrial Management\n<b>Download:<\/b>\nAdministrator\nData Management\nData Management +\nTrial Management","definition":"SELECT DISTINCT record,\n       concat('<a href=\"', $$WEBROOT$$, 'DataEntry\/index.php?pid=', $$PROJECT$$, '&id=', record, '&page=', m.form_name,\n              '&event_id=', d.event_id, '&instance=', ifnull(d.instance,''), '\">', m.form_name,'<\/a>') AS form_name,\n       em.descrip AS event,\n       ifnull(d.instance,1) AS instance,\n       d.field_name,\n       m.element_label,\n       d.value\nFROM $$DATATABLE$$ d\n     INNER JOIN redcap_metadata m\n     ON d.field_name = m.field_name AND d.project_id = m.project_id\n     INNER JOIN redcap_events_metadata em\n     ON d.event_id = em.event_id\nWHERE d.project_id = $$PROJECT$$\n      AND m.element_type IN ('textarea', 'text')\n      AND isnull(m.element_validation_type)\n      AND m.misc NOT LIKE ('%@HIDDEN%')\n    -- exclusion list may need updating in each project.\n      AND m.field_name NOT IN ('record_id')\n      AND m.field_phi is null\nORDER BY d.value","options":""},{"title":"Summary Progress Report","type":"SQL","description":"Displays a summary of participant progress.","permissions":"<b>View Access:<\/b>\nTrial Management\r\nData Management\r\nData Management +\n<b>Download:<\/b>\nTrial Management\r\nData Management\r\nData Management +","definition":"SELECT * FROM (\r\n\r\nWITH sites AS\r\n(\r\n  -- dags data \r\n  SELECT group_id, group_name FROM redcap_data_access_groups\r\n  WHERE project_id = $$PROJECT$$  ORDER BY group_name\r\n),\r\nevents AS\r\n(\r\n  SELECT event_id AS id, descrip AS name\r\n  FROM redcap_events_metadata JOIN redcap_events_arms ON redcap_events_metadata.arm_id = redcap_events_arms.arm_id\r\n  WHERE project_id = $$PROJECT$$\r\n),\r\npt_sites AS\r\n(\r\n  SELECT DISTINCT record, value AS group_id FROM redcap_data\r\n  WHERE project_id = $$PROJECT$$ AND field_name = '__GROUPID__'\r\n),\r\npt_data AS\r\n(\r\n  SELECT (SELECT group_id FROM pt_sites WHERE pt_sites.record = redcap_data.record) AS group_id, record,\r\n         (SELECT name FROM events WHERE id = event_id) AS event_name, field_name, value\r\n  FROM redcap_data WHERE project_id = $$PROJECT$$ HAVING group_id IS NOT NULL\r\n),\r\npt_baseline AS\r\n(\r\n  -- sum of completed forms in baseline event\r\n  SELECT group_id,\r\n         sum(if( record IN( SELECT record FROM pt_data\r\n                            WHERE pt_data.group_id = pt_sites.group_id AND event_name = 'Baseline'\r\n                            AND field_name = 'patient_evaluated_measure_pem_preinjury_complete' AND value = '2' ) AND\r\n                 record IN( SELECT record FROM pt_data\r\n                            WHERE pt_data.group_id = pt_sites.group_id AND event_name = 'Baseline'\r\n                            AND field_name = 'euroqol_eq5d5l_preinjury_complete' AND value = '2' ) AND\r\n                 record IN( SELECT record FROM pt_data\r\n                            WHERE pt_data.group_id = pt_sites.group_id AND event_name = 'Baseline'\r\n                            AND field_name = 'patient_evaluated_measure_pem_now_complete' AND value = '2' ) AND\r\n                 record IN( SELECT record FROM pt_data\r\n                            WHERE pt_data.group_id = pt_sites.group_id AND event_name = 'Baseline'\r\n                            AND field_name = 'euroqol_eq5d5l_now_complete' AND value = '2' ) AND\r\n                 record IN( SELECT record FROM pt_data\r\n                            WHERE pt_data.group_id = pt_sites.group_id AND event_name = 'Baseline'\r\n                            AND field_name = 'sane_complete' AND value = '2' ) AND\r\n                 ( record IN( SELECT record FROM pt_data\r\n                              WHERE pt_data.group_id = pt_sites.group_id AND event_name = 'Baseline'\r\n                              AND field_name = 'promis_upper_extremity_complete' AND value = '2' ) OR\r\n                   record IN( SELECT record FROM pt_data\r\n                              WHERE pt_data.group_id = pt_sites.group_id AND event_name = 'Baseline'\r\n                              AND field_name = 'promis_upper_extremity_short_form_complete' AND value = '2' ) ) AND\r\n                 record IN( SELECT record FROM pt_data\r\n                            WHERE pt_data.group_id = pt_sites.group_id AND event_name = 'Baseline'\r\n                            AND field_name = 'randomised_complete' AND value = '2' ) AND\r\n                 record IN( SELECT record FROM pt_data\r\n                            WHERE pt_data.group_id = pt_sites.group_id AND event_name = 'Baseline'\r\n                            AND field_name = 'adherence_complete' AND value = '2' )\r\n                ,1,0)) AS total\r\n  FROM pt_sites\r\n  GROUP BY group_id\r\n),\r\npt_treatment AS\r\n(\r\n  -- sum of completed forms in Treatment record event\r\n  SELECT group_id,\r\n         sum(if( record IN( SELECT record FROM pt_data\r\n                            WHERE pt_data.group_id = pt_sites.group_id AND event_name = 'Treatment record'\r\n                            AND field_name = 'splint_treatment_record_complete' AND value = '2' ) OR\r\n                 record IN( SELECT record FROM pt_data\r\n                            WHERE pt_data.group_id = pt_sites.group_id AND event_name = 'Treatment record'\r\n                            AND field_name = 'surgery_treatment_record_complete' AND value = '2' )\r\n                ,1,0)) AS total\r\n  FROM pt_sites\r\n  GROUP BY group_id\r\n)\r\n-- display site name\r\nSELECT sites.group_name AS Site,\r\n       -- total of participants\r\n       (SELECT count(*) FROM pt_sites WHERE pt_sites.group_id = sites.group_id) AS Participants,\r\n       (SELECT total FROM pt_baseline WHERE pt_baseline.group_id = sites.group_id) AS Baseline,\r\n       (SELECT total FROM pt_treatment WHERE pt_treatment.group_id = sites.group_id) AS `Treatment record`\r\nFROM sites\r\n\r\n) AS tbl","options":""},{"title":"Forms Not Soft Locked","type":"SQL","description":"Participant ID, Form name, Form Instance\n\nDisplays a list of forms that are not soft-locked\r\nNote: if no data has been entered in the form, i.e. form has never been saved, then the form will not appear in this list.","permissions":"<b>View Access:<\/b>\nAdministrator\nData Management\nData Management +\n<b>Download:<\/b>\nAdministrator\nData Management\nData Management +","definition":"SELECT DISTINCT CONCAT('<a href=\"', $$WEBROOT$$, '\/DataEntry\/record_home.php?pid=', records.project_id, '&id=', records.record, '\">', records.record, '<\/a>')\n         AS \"Participant ID\",\n       CONCAT('<a href=\"', $$WEBROOT$$, '\/DataEntry\/index.php?pid=', records.project_id, '&id=', records.record, '&page=', metadata.form_name,\n              '&event_id=', data.event_id, '&instance=', IFNULL(data.instance, 1), '\">', metadata.form_name, '<\/a>') AS 'Form name',\n       IFNULL(data.instance, '1') AS 'Form Instance'\nFROM redcap_record_list as records\nINNER JOIN redcap_metadata as metadata ON  metadata.project_id = records.project_id\nINNER JOIN redcap_events_forms as event_forms ON event_forms.form_name = metadata.form_name\nINNER JOIN $$DATATABLE$$ as data\n           ON data.project_id = records.project_id AND data.record = records.record\n           AND metadata.field_name = data.field_name AND data.event_id = event_forms.event_id\nLEFT JOIN redcap_locking_data as lock_data ON lock_data.project_id = records.project_id AND lock_data.record = records.record\n          AND lock_data.event_id = data.event_id AND lock_data.form_name = metadata.form_name\nWHERE records.project_id = $$PROJECT$$ AND lock_data.timestamp IS NULL\nORDER BY records.record, metadata.form_name, data.instance\n","options":""},{"title":"User Details Audit","type":"SQL","description":"Change date, Change by user, Change by full name, User, User full name, User email, Action, Role and DAGs\n\nDisplays all changes to users and role and DAG membership in this project.  Shows: Change date, Change by full name, User, User full name, User email, Action, Role and DAGs","permissions":"<b>View Access:<\/b>\nAdministrator\nData Management\nData Management +\nTrial Management\n<b>Download:<\/b>\nAdministrator\nData Management\nData Management +\nTrial Management","definition":"SELECT DATE_FORMAT(log.ts, '%Y-%m-%d %H:%i:%s') AS 'Change date',\n       log.user AS 'Change by user',\n       CONCAT(ui1.user_firstname, ' ' ,ui1.user_lastname) AS 'Change by full name',\n       IF(description RLIKE 'DAG Switcher|User Management', ui3.username, log.pk) AS User,\n       IF(description RLIKE 'DAG Switcher|User Management',\n          CONCAT(ui3.user_firstname, ' ', ui3.user_lastname),\n          CONCAT(ui2.user_firstname, ' ' ,ui2.user_lastname)) AS 'User full name',\n       IF(description rlike 'DAG Switcher|User Management', ui3.user_email, ui2.user_email) AS 'User email',\n       log.description AS Action,\n       log.data_values AS 'Role and DAGs'\nFROM $$LOGTABLE$$ log\nLEFT JOIN redcap_user_information as ui1 ON ui1.username = log.user\nLEFT JOIN redcap_user_information as ui2 ON ui2.username = log.pk\nLEFT JOIN redcap_user_information as ui3 ON ui3.username = REGEXP_SUBSTR(data_values, \"(?<=\\')(.*?)(?=\\')\")\nWHERE log.project_id = $$PROJECT$$\n      AND log.description LIKE '%user%'\n      AND log.description NOT LIKE '%Export users%'\n      AND log.description NOT LIKE '%Download user-role assignment%'\n      AND log.description NOT LIKE '%View project as user%'\n      AND log.description NOT LIKE '%Stop viewing project as user%'\nORDER BY log_event_id DESC;   ","options":""},{"title":"Instruments with multiple editors","type":"SQL","description":"Shows user details, form, event and instance for those forms edited by more than one user. Does not include a multiple edit if second editor was only setting the form status to complete.","permissions":"<b>View Access:<\/b>\nTrial Management\r\nData Management\r\nData Management +\n<b>Download:<\/b>\nTrial Management\r\nData Management\r\nData Management +","definition":"select \r\n\trle.user,\r\n\trui.user_email,\r\n\tconcat_ws(' ', rui.user_firstname, user_lastname) as userfullname,\r\n\t(select form_name from redcap_metadata where project_id = $$PROJECT$$ and field_name=left(rle.data_values, instr(rle.data_values, ' '))) as FormName,\r\n\trle.pk as participant_id,\r\n\trem.descrip as event_name,\r\n\tregexp_replace(substring_index(substring_index(rle.sql_log, ';', 1), ' ', -1), \"[ ')]+\", '') as instance,\r\n\trle.ts,\r\n\trle.data_values \r\nfrom \r\n        $$LOGTABLE$$ rle \r\ninner join\r\n\tredcap_user_information rui on rui.username = rle.user\r\ninner join\r\n\tredcap_events_metadata rem on rle.event_id = rem.event_id\r\nwhere\r\n\tproject_id = $$PROJECT$$ and page <> 'surveys\/index.php' and event <> 'LOCK_RECORD' and\r\n    -- build string to match form_name-pk-event_id-instance in query where >1 user has edited this the same form\/participant\/event\/instance combination.\r\n\tconcat_ws('-',(select form_name from redcap_metadata where project_id = $$PROJECT$$ and field_name=left(regexp_replace(rle.data_values, \"^\\\\[instance = [0-9]+\\\\]+,\\n\", ''), instr(regexp_replace(rle.data_values, \"^\\\\[instance = [0-9]+\\\\],\\n\", ''), ' '))), rle.pk, rle.event_id, regexp_replace(substring_index(substring_index(rle.sql_log, ';', 1), ' ', -1), \"[ ')]+\", '') ) in\r\n(select formpkeventid from(select\r\n    count(*) as usercount, \r\n    userformpkevent.formpkeventid\r\nfrom\r\n\t(select distinct\r\n\t\tuser, \r\n        concat_ws('-', (select form_name as fn from redcap_metadata where project_id = $$PROJECT$$ and field_name=left(regexp_replace(data_values, \"^\\\\[instance = [0-9]+\\\\]+,\\n\", ''), instr(regexp_replace(data_values, \"^\\\\[instance = [0-9]+\\\\],\\n\", ''), ' '))), pk, event_id, regexp_replace(substring_index(substring_index(sql_log, ';', 1), ' ', -1), \"[ ')]+\", '')) as formpkeventid\r\n\tfrom\r\n\t\t$$LOGTABLE$$\r\n\twhere\r\n\t\tproject_id = $$PROJECT$$ and page = 'DataEntry\/index.php' and event = 'UPDATE' and sql_log like 'UPDATE%' and data_values not like concat((select form_name as fn from redcap_metadata where project_id = $$PROJECT$$ and field_name=left(regexp_replace(data_values, \"^\\\\[instance = [0-9]+\\\\]+,\\n\", ''), instr(regexp_replace(data_values, \"^\\\\[instance = [0-9]+\\\\],\\n\", ''), ' '))),\"_complete = '2'\")) as userformpkevent\r\ngroup by \r\n\tformpkeventid \r\nhaving \r\n\tusercount > 1) as table1)\r\n    order by pk, FormName, rle.event_id, instance, ts asc;","options":""},{"title":"Data Categories: All","type":"SQL","description":"Data Category, Form Name, Field Label, Field Name, Field Required, Participant Identifier, Category, Identifier Flagged in DB","permissions":"<b>View Access:<\/b>\nData Management\nData Management +\nTrial Management\n<b>Download:<\/b>\nData Management\nData Management +\nTrial Management","definition":"SELECT REPLACE(LEFT(misc, IF(INSTR(misc, '@')>0, LOCATE('@', misc), LENGTH(misc))), '@', '') AS 'Data Category', \n       CONCAT('<a href=\"', $$WEBROOT$$, '\/Design\/online_designer.php?pid=', $$PROJECT$$, '&page=', form_name, '\">', form_name, '<\/a>') as 'Form Name',\n       element_label as 'Field Label',\n       field_name as 'Field Name',\n       IF(field_req = 1, 'Yes', 'No') as 'Field Required',\n       IF(INSTR(misc, 'Participant Identifier') > 0, 'Set', 'Not Set') as 'Participant Identifier Category',\n       IF(field_phi = 1, 'Yes', 'No') as 'Identifier Flagged in DB'\nFROM redcap_metadata\nWHERE project_id = $$PROJECT$$ AND\n      ( REPLACE( REPLACE( REPLACE ( REPLACE ( REPLACE ( REPLACE (\n        REPLACE ( REPLACE ( REPLACE ( REPLACE ( REPLACE ( REPLACE (\n        REPLACE ( REPLACE ( REPLACE ( REPLACE ( REPLACE ( REPLACE (\n        REPLACE ( REPLACE ( REPLACE ( REPLACE ( REPLACE ( REPLACE (\n        LEFT(misc, IF(INSTR(misc, '@')>0, LOCATE('@', misc), LENGTH(misc))),\n         'Primary Outcome', ''),\n         'Primary Outcome Not Primary Analysis', ''),\n         'Secondary Outcome', ''),\n         'Other Outcome', ''),\n         'Core Outcome', ''),\n         'Health Economics', ''),\n         'Participant Identifier', ''),\n         'Randomisation', ''),\n         'Eligibility', ''),\n         'Demographics', ''),\n         'Medical History', ''),\n         'Data Management', ''),\n         'Safety Data', ''),\n         'Regulatory Data', ''),\n         'Compliance Data', ''),\n         'Process Outcome', ''),\n         'Unblinding', ''),\n         'Derived', ''),\n         'Miscellaneous', ''),\n        ',',''),\n        ' ',''),\n        '@', ''), \n        '\\n', ''),\n        '\\r', '')  = '' AND REPLACE(LEFT(misc, IF(INSTR(misc, '@')>0, LOCATE('@', misc), LENGTH(misc))), '@', '') <> ''\n      OR ifnull(field_phi, '') = 1) \nORDER BY form_name","options":""},{"title":"Data Categories: Missing","type":"SQL","description":"Displays all fields that do not have a Data Category assigned.","permissions":"<b>View Access:<\/b>\nData Management\nData Management +\nTrial Management\n<b>Download:<\/b>\nData Management\nData Management +\nTrial Management","definition":"SELECT\n     misc as \"Missing Data Category\",\n     concat('<a href=\"',$$WEBROOT$$, '\/Design\/online_designer.php?pid=',$$PROJECT$$,'&page=',form_name,'\">', form_name,'<\/a>') as \"Form Name\",\n     element_label as \"Field Label\",\n     field_name as \"Field Name\"\nFROM \n\tredcap_metadata\nWHERE\n\tproject_id = $$PROJECT$$\n    AND\n    element_label <> 'Complete?'\n    AND\n    INSTR(IFNULL(misc, ''), '@HIDDEN') = 0 \n    AND\n    NOT(\n    INSTR(IFNULL(misc, ''), 'Primary Outcome') <> 0 OR\n    INSTR(IFNULL(misc, ''), 'Primary Outcome Not Primary Analysis') <> 0 OR\n    INSTR(IFNULL(misc, ''), 'Secondary Outcome') <> 0 OR\n    INSTR(IFNULL(misc, ''), 'Other Outcome') <> 0 OR\n    INSTR(IFNULL(misc, ''), 'Core Outcome') <> 0 OR\n    INSTR(IFNULL(misc, ''), 'Health Economics') <> 0 OR\n    INSTR(IFNULL(misc, ''), 'Participant Identifier') <> 0 OR\n    INSTR(IFNULL(misc, ''), 'Randomisation') <> 0 OR\n    INSTR(IFNULL(misc, ''), 'Eligibility') <> 0 OR\n    INSTR(IFNULL(misc, ''), 'Demographics') <> 0 OR\n    INSTR(IFNULL(misc, ''), 'Medical History') <> 0 OR\n    INSTR(IFNULL(misc, ''), 'Data Management') <> 0 OR\n    INSTR(IFNULL(misc, ''), 'Safety Data') <> 0 OR\n    INSTR(IFNULL(misc, ''), 'Regulatory Data') <> 0 OR\n    INSTR(IFNULL(misc, ''), 'Compliance Data') <> 0 OR\n    INSTR(IFNULL(misc, ''), 'Process Outcome') <> 0 OR\n    INSTR(IFNULL(misc, ''), 'Unblinding') <> 0 OR\n    INSTR(IFNULL(misc, ''), 'Derived') <> 0 OR\n    INSTR(IFNULL(misc, ''), 'Miscellaneous') <> 0);\n    \n    ","options":""},{"title":"Data Categories: Unknown","type":"SQL","description":"Displays any text in the field annotations that don't match the allowed data category types.","permissions":"<b>View Access:<\/b>\nData Management\nData Management +\nTrial Management\n<b>Download:<\/b>\nData Management\nData Management +\nTrial Management","definition":"select\n    misc AS \"Unknown Data Category\", \n     concat('<a href=\"',$$WEBROOT$$, '\/Design\/online_designer.php?pid=',$$PROJECT$$,'&page=',form_name,'\">', form_name,'<\/a>') as \"Form Name\",\n     element_label as \"Field Label\",\n     field_name as \"Field Name\"\nFROM\n\tredcap_metadata\nWHERE\n\tproject_id = $$PROJECT$$\n\tAND\n    REPLACE( REPLACE( REPLACE ( REPLACE ( REPLACE ( REPLACE (\n    REPLACE ( REPLACE ( REPLACE ( REPLACE ( REPLACE ( REPLACE (\n    REPLACE ( REPLACE ( REPLACE ( REPLACE ( REPLACE ( REPLACE (\n    REPLACE ( REPLACE ( REPLACE ( REPLACE ( REPLACE ( REPLACE (\n    LEFT(misc, IF(INSTR(misc, '@')>0, LOCATE('@', misc), LENGTH(misc))),\n    'Primary Outcome', ''),\n    'Primary Outcome Not Primary Analysis', ''),\n    'Secondary Outcome', ''),\n    'Other Outcome', ''),\n    'Core Outcome', ''),\n    'Health Economics', ''),\n    'Participant Identifier', ''),\n    'Randomisation', ''),\n    'Eligibility', ''),\n    'Demographics', ''),\n    'Medical History', ''),\n    'Data Management', ''),\n    'Safety Data', ''),\n    'Regulatory Data', ''),\n    'Compliance Data', ''),\n    'Process Outcome', ''),\n    'Unblinding', ''),\n    'Derived', ''),\n    'Miscellaneous', ''),\n    ',',''),\n    ' ',''),\n    '@', ''), \n     '\\n', ''),\n     '\\r', '')  <> ''; -- after stripping off @ACTIONtags and any known data category text, anything left is unknown\n    ","options":""},{"title":"Enrolment Accrual","type":"Accumulation","description":"Display figures with accumulative for the month.","permissions":"<b>View Access:<\/b>\nData Management\nData Management +\nTrial Management\n<b>Download:<\/b>\nData Management\nData Management +\nTrial Management","definition":"<b>Accumulation range:<\/b>\n- Start: 2025 * 12\n- End: (year('today') * 12) + month('today') - 1\n<b>Accumulation logic:<\/b>\nif(\n[accumulation-number] >= ( year([trial_data__baby_arm_1][babyenrol_dob]) * 12 ) + month([trial_data__baby_arm_1][babyenrol_dob]) - 1,\n1, 0\n)\n<b>Group by:<\/b>\n[record-dag-label]\n<b>Column label logic:<\/b>\nconcat(\nif( mod([accumulation-number],12) = 0, 'Jan', if( mod([accumulation-number],12) = 1, 'Feb', if( mod([accumulation-number],12) = 2, 'Mar', if( mod([accumulation-number],12) = 3, 'Apr', if( mod([accumulation-number],12) = 4, 'May', if( mod([accumulation-number],12) = 5, 'Jun', if( mod([accumulation-number],12) = 6, 'Jul', if( mod([accumulation-number],12) = 7, 'Aug', if( mod([accumulation-number],12) = 8, 'Sep', if( mod([accumulation-number],12) = 9, 'Oct', if( mod([accumulation-number],12) = 10, 'Nov', 'Dec' ) ) ) ) ) ) ) ) ) ) ),\n' ', rounddown([accumulation-number]\/12)\n)","options":"<b>Display format:<\/b>\ncumul\/diff\n<b>Display options:<\/b>\nAdd a 'Total' row\nColumns in reverse order"},{"title":"ESendex SMS & Email Alerts Log","type":"SQL","description":"Alert ID, Alert Title, Alert Logged Date\/Time, Alert Description, Alert Details\n\nShows log of all ESendex module SMS and Email alerts sent.","permissions":"<b>View Access:<\/b>\nTrial Management\n<b>Download:<\/b>\nTrial Management","definition":"SELECT log.pk as 'Alert ID',  (em_config.value->>'$.\"alert-title\"') AS 'Alert Title',  \n DATE_FORMAT(log.ts,'%d-%m-%Y %h:%i') AS 'Alert logged Date\/Time', log.description as 'Alert Description', log.data_values as 'Alert Details'\nFROM $$LOGTABLE$$ as log\n INNER JOIN redcap.redcap_external_module_settings as em_config ON em_config.key = concat('p', $$PROJECT$$,  '-alert-config-', log.pk)\nWHERE log.project_id = $$PROJECT$$ AND sql_log= 'Sending alert'\norder by log.pk, log_event_id desc","options":""},{"title":"Site Notification Email Alert Log","type":"SQL","description":"Alert ID, Alert Title, Alert Logged Date\/Time, Alert Description, Alert Details\n\nShows log of all Site Notification Email alerts sent.","permissions":"<b>View Access:<\/b>\nAdministrator\nData Management\nData Management +\nNEWS-HEAT Data Management\nNEWS-HEAT Project Management\nTrial Management\n<b>Download:<\/b>\nAdministrator\nData Management\nData Management +\nNEWS-HEAT Data Management\nNEWS-HEAT Project Management\nTrial Management","definition":"SELECT log.pk as 'Alert ID',  (em_config.value->>'$.\"alert-title\"') AS 'Alert Title',  \n DATE_FORMAT(log.ts,'%d-%m-%Y %h:%i') AS 'Alert logged Date\/Time', log.description as 'Alert Description', log.data_values as 'Alert Details'\nFROM $$LOGTABLE$$ as log\n INNER JOIN redcap.redcap_external_module_settings as em_config ON em_config.key = concat('p', $$PROJECT$$,  '-alert-config-', log.pk)\nWHERE log.project_id = $$PROJECT$$ AND sql_log= 'Sending alert' AND (em_config.value->>'$.\"alert-title\"') = \"Site Notification Email\"\norder by log.pk, log_event_id desc","options":""},{"title":"DAG ID's and Intervention Groups","type":"SQL","description":"","permissions":"<b>View Access:<\/b>\nAdministrator\n<b>Download:<\/b>\nAdministrator","definition":"SELECT rand_group AS \"Intervention Group\", dag_id AS \"DAG ID\" FROM (\nWITH \nsites AS (SELECT * FROM $$DATATABLE$$ WHERE project_id = $$PROJECT$$ AND field_name = \"ref_id_arm3_valid\" AND value = 1),\nrand_groups AS (SELECT * FROM $$DATATABLE$$ WHERE project_id = $$PROJECT$$ AND field_name = \"site_rand_grp\"),\ndag_ids AS (SELECT * FROM $$DATATABLE$$ WHERE project_id = $$PROJECT$$ AND field_name = \"__GROUPID__\"),\n\nlist AS (SELECT DISTINCT\n(SELECT value FROM rand_groups AS rg WHERE rg.record = lst.record) AS rand_group,\n(SELECT value FROM dag_ids AS di WHERE di.record = lst.record) AS dag_id\nFROM sites as lst\n)\nSELECT * from list ORDER BY rand_group \n\n) AS tbl","options":""}]}